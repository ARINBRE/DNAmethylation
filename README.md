# DNAmethylation_ArrayAnalysis

## Objective
This educational module demonstrates the steps needed to process raw files generated by Illumina's Infinium beadchip array 450k (or the 850k EPIC chip) and perform differential methylation analysis at the probe level. The workflow uses R and Bioconductor packages and includes downloading raw data files from the Gene Expression Omnibus (GEO) repository. Both R code and the same R code within a Jupyter Notebook environment are available.

## Setup and Installation
The module was conducted using R version 4.1.2 in a Jupyter Notebook with an R kernel. The associated Anaconda environment for the Jupyter Notebook is provided in file environment.yaml. If you use R, ensure the proper version is installed on your machine along with the required libraries. Ti install Bioconductor packages, packge **Biocmanager** is required. You can install it using the following line:

```R
if (!requireNamespace("BiocManager", quietly = TRUE)) install.packages("BiocManager")
```

Then use package BiocManager to install the Bioconductor packages needed in this module:

```R
if (!requireNamespace("GEOquery", quietly = TRUE)) BiocManager::install("GEOquery")
if (!requireNamespace("minfi", quietly = TRUE)) BiocManager::install("minfi")
if (!requireNamespace("IlluminaHumanMethylation450kmanifest", quietly = TRUE)) BiocManager::install("IlluminaHumanMethylation450kmanifest")
if (!requireNamespace("IlluminaHumanMethylation450kanno.ilmn12.hg19", quietly = TRUE)) BiocManager::install("IlluminaHumanMethylation450kanno.ilmn12.hg19")
if (!requireNamespace("limma", quietly = TRUE)) BiocManager::install("limma")
```

If you prefer to work with EndNote, import the yaml environment file into your anaconda and install R packages as shown above. Alternatively, you can create your own conda environment. For example:
```
conda create -n r_env r-base=4.1.2 r-essentials -y
```
After installing a conda environment, install R kernel. One possible way is to activate the environment and istall from R: 
```
conda activate r_env
R -e "install.packages('IRkernel'); IRkernel::installspec(user = FALSE)"
```

Installing some packages that serve as dependencies directly from R using install.packages may be problematic. Installing specific versions of R packages from conda will likely resolve this issue. Some examples of problematic packages are shown below:
```
conda install -c r r-Matrix=1.5-4
conda install -c r r-matrixStats=0.62.0
conda install -c r r-locfit=1.5-9.6
conda install -c r r-filelock=1.0.2
conda install -c r r-rjson=0.2.21
conda install -c r r-plyr=1.8.7
conda install -c r r-mclust=5.4.10
```
